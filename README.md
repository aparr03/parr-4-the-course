# Recipe App

## Docker Setup

This project uses Docker for both development and production environments. The configuration uses a single `docker-compose.yml` file with environment-specific settings.

### Prerequisites

- Docker Desktop
- A Supabase account and project with appropriate credentials

### Setup Instructions

#### Using Start and Cleanup Scripts

1. Update your Supabase credentials in the environment files:
   - `.env.development` for development
   - `.env.production` for production

2. Start the application:

   ```
   # Development mode (default)
   npm run start:dev
   
   # Production mode
   npm run start:prod
   
   # Stop containers
   npm run stop
   
   # Clean up project files
   npm run clean
   
   # Deep clean (removes node_modules)
   npm run clean:deep
   ```

#### Using Docker Compose Directly

1. Update your Supabase credentials in the `.env` file

2. Run Docker Compose:
   ```
   # Start containers
   docker-compose up -d

   # Stop containers
   docker-compose down
   ```

### Development Without Docker

You can also run the application without Docker:

1. Start the API server:
   ```
   cd api
   npm install
   npm run dev:build-start
   ```

2. In another terminal, start the frontend:
   ```
   npm install
   npm run dev
   ```

## Project Structure

```
parr-4-the-course/
├── api/                   # Backend API codebase
│   ├── src/               # Source code
│   │   ├── lib/           # Shared libraries
│   │   ├── middleware/    # Request middleware
│   │   └── routes/        # API routes
│   ├── .env               # API environment variables (local dev only)
│   └── package.json       # API dependencies
├── src/                   # Frontend codebase
│   ├── components/        # React components
│   ├── context/           # React context providers
│   ├── hooks/             # Custom React hooks
│   ├── lib/               # Shared libraries
│   ├── pages/             # Page components
│   ├── services/          # API service clients
│   ├── styles/            # CSS styles
│   └── utils/             # Utility functions
├── nginx/                 # Nginx config for production
├── dist/                  # Build output directory (generated)
├── .env                   # Main environment variables
├── .env.development       # Development environment variables
├── .env.production        # Production environment variables
├── docker-compose.yml     # Docker configuration
└── package.json           # Project dependencies and scripts
```

## File Organization

- **Authentication**: 
  - Backend: `/api/src/middleware/auth.ts` (middleware) and `/api/src/routes/auth.ts` (API endpoints)
  - Frontend: `/src/context/AuthContext.tsx` (React context for auth state)

- **Build artifacts**: 
  - `/dist/` contains production-ready built files (minified JS/CSS)
  - These are generated by the build process and should not be edited directly

- **Nginx**: 
  - Used in production mode to serve the frontend and proxy API requests
  - Configuration in `/nginx/default.conf`

## Environment Files

- `.env` - Default environment settings (copied from profile-specific env files)
- `.env.development` - Development settings
- `.env.production` - Production settings

## Troubleshooting Docker Issues

If you encounter Docker issues:

1. Make sure Docker Desktop is running
2. Try resetting Docker Desktop
3. Check for valid Supabase credentials in your .env files
4. If Docker continues to fail, use the non-Docker development approach 